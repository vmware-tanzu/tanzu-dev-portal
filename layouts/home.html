{{/* TEMPLATES */}}
{{ define "featuredCard" }}
<div class="col-12 col-lg-4 mb-4">
    <a href="{{ .RelPermalink }}">
        <div class="card">
            <div class="card-type-id"><img class="d-inline-block" src="{{ `images/icons/icon-book.svg` | relURL }}"
                    alt=""><span class="h5">{{ .contentType }}</span></div>
            <div class="card-body">
                <h5 class="card-title text-dark">{{ .Title }}</h5>
                <p class="card-text">{{ .Description }}</p>
            </div>
        </div>
    </a>
</div>
{{ end }}

{{ define "advocateCard" }}
<div class="col-12 col-lg-4">
    <div class="card">
        <img src="{{ partial `team-photo-src.html` . }}" alt="{{ .Params.name }} Image" class="card-img-top">
        <div class="card-body">
            <h5 class="card-title" style="color:black">{{ .Params.name }}</h5>
            <p class="card-text">{{ .Params.description }}</p>
        </div>
        <div class="card-footer">
            <small class="text-muted">{{ range .Params.skills }}{{ . }} {{ end }}</small> {{/*TODO Add icons for skills
            in footer Or remove footer altogether?*/}}
        </div>
    </div>
</div>
{{ end }}

{{ define "topicCard" }}
<div class="topic-card flex-315 td-box td-box-dark mb-lg-0 mb-3">
    <a href="{{ .RelPermalink }}"
        class="h-100 d-flex flex-column justify-content-center align-items-center py-4 py-lg-5 px-3">
        <div class="card">
            <div class="card-type-id"><img class="d-inline-block" src="{{ `images/icons/icon-book.svg` | relURL }}"
                    alt=""><span class="h5">{{ .contentType }}</span></div>
            <div class="card-body">
                <h5 class="card-title text-dark">{{ .Title }}</h5>
                <p class="card-text">{{ .Description }}</p>
            </div>
        </div>
    </a>
</div>
{{ end }}

{{ define "main" }}

{{/* VARS */}}
{{ $topicGroups := .Params.topicGroups }}
{{ $topicPages := (.Site.GetPage "taxonomyTerm" "topics").Pages }}
{{ $advocatePages := where (where .Site.Pages "Section" "team") "Params.roles" "intersect" (slice "advocate")}}
{{ $learningpaths := where (where .Site.Pages "Section" "learningpaths") ".Params.featured" true }}


<h1 class='d-none'>{{ .Title }} Homepage</h1>

<section id="hero" class="td-box td-box--primary position-relative td-box--height-auto overflow-hidden">
    <div id="home-featured" class="container">
        <div class="row text-center">
            <div class="col-12">
                <h1>{{ .Params.tagline }}</h1>
            </div>
            <p>{{ .Params.description }}</p>
            <div class="container py-5 px-0">
                <div class="row mx-auto">
                    {{ range .Params.featured }}
                    {{ $contentType := .contentType}}
                    {{ with $.Site.GetPage .name }}
                    {{ template "featuredCard" (dict "Title" .Title "Description" .Description "contentType"
                    $contentType) }}
                    {{ end }}
                    {{ end }}
                </div>
            </div>
        </div>
    </div>
</section>

<section class="td-box">
    <div id="home-topics" class="container">
        <div id="topics-row-outer"
            class="td-box td-box--gradient td-box--height-auto pt-0 position-relative transition-all">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Title</th>
                        <th scope="col">Level 1</th>
                        <th scope="col">Level 2</th>
                        <th scope="col">Tags</th>
                        <th scope="col">Url</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range $topicGroups }}
                    {{ $topicName := .name }}
                    {{ range $.Site.Pages }}
                    {{ if or (eq .Params.level1 $topicName) (eq .Params.level2 $topicName)}}
                    <tr>
                        <th scope="row">{{ .Title }}</th>
                        <td>{{ .Params.level1 }}</td>
                        <td>{{ .Params.level2 }}</td>
                        <td>{{ .Params }}</td>
                        <td>{{ .Permalink }}</td>
                    </tr>
                    {{ end }}
                    {{ end }}
                    {{ end }}
                </tbody>
            </table>
            {{/*  {{ range $topicGroups }}
            <div class="row mb-5 transition-all">
                <div class="col-xl-3 col-12 d-flex d-xl-block justify-content-center mb-xl-0 mb-4">
                    <h2>{{ .name }}</h2>
                </div>
                <div class="col-xl-9 col-12 mb-xl-0 mb-lg-4 mb-2">
                    <div id="{{ .name | urlize }}" class="row justify-content-between w-100 td-box topics-row">
                        <a href="{{ .RelPermalink }}"
                            class="h-100 d-flex flex-column justify-content-center align-items-center py-4 py-lg-5 px-3"></a>
                    </div>
                </div>
            </div>
            {{ end }}  */}}
        </div>
    </div>
</section>

<section class="td-box td-box--gray-dark td-box--gradient td-box--height-auto">
    <h2 id="home-advocates" class="text-center">Developer Advocates</h2>
    <div class="container-fluid">
        <div class="row d-flex flex-row flex-nowrap overflow-auto">
            {{ range $advocatePages }}
            {{ template "advocateCard" . }}
            {{ end }}
        </div>
    </div>
    </div>
</section>

<script>
    { {/*  TODO  */ } }
    $("#nav-modern-applications-tab").hover((e) => {
        $("#nav-modern-applications-tab").tab("show");
    });
    $("#nav-application-development-tab").hover((e) => {
        $("#nav-application-development-tab").tab("show");
    });
    $("#nav-kubernetes-platform-tab").hover((e) => {
        $("#nav-kubernetes-platform-tab").tab("show");
    });
</script>

<script>sendAmplitudeEventOnLoad('home viewed', { 'url path': window.location.pathname });</script>

{{ with .Content }}
{{ . }}
{{ end }}

{{ end }}