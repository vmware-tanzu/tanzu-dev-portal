{{ if or (strings.HasPrefix .Destination ".") (strings.HasPrefix .Destination "#") (strings.HasPrefix .Destination "mailto:") }}<a href="{{ .Destination | safeURL }}"{{ with .Title}} title="{{ . }}"{{ end }}>{{ .Text | safeHTML }}</a>{{ else if (and (not (or (strings.HasPrefix .Destination "/") (strings.HasPrefix .Destination "http"))) (or (eq .Page.File.BaseFileName "index") (eq .Page.File.BaseFileName "_index"))) }}<a href="{{ print .Page.Permalink (substr .Destination 1) | relURL | safeURL }}"{{ with .Title}} title="{{ . }}"{{ end }}>{{ .Text | safeHTML }}</a>{{ else }}{{ if strings.HasPrefix .Destination "/" }}<a href="{{ substr .Destination 1 | safeURL | relURL }}"{{ else }}<a href="{{ .Destination | safeURL | relURL }}"{{ end }}{{ with .Title}} title="{{ . }}"{{ end }}{{ if strings.HasPrefix .Destination "http" }} target="_blank" rel="nofollow"{{ end }}>{{ .Text | safeHTML }}</a>{{ end }}