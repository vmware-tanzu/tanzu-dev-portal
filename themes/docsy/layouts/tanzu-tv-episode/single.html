{{ define "main" }}

{{ $class := replace .Page.Section "." "-" | lower }}
<section id="hero" class="{{ $class }}-episode-hero bg-gray-dark mt-lg-5 mt-0 mb-5 pt-lg-5 pt-2 pb-1">
	<div class="container">
		{{ if not .Site.Params.ui.breadcrumb_disable }}{{ partial "breadcrumb.html" . }}{{ end }}
    <h1 class="h1"> {{ .Parent.Title -}}</h1>
    <div class="lead"><p class="mb-5">{{- .Parent.Params.description}}</p></div>
   </div>
</section>

<!-- IF UPCOMING -->
<div class='container'>
  <div id="twitch" class="row justify-content-center">
    <div class="col-5 mb-5">
      <h1 class="h1"> {{- .Title -}}</h1>
      <div>
        <a href="https://www.twitch.tv/{{ .Params.twitch }}"><img class="float-left" src='{{ "/images/icons/play-button.png" | relURL }}'></a>
        <div class="float-left ml-3">
          <a href="https://www.twitch.tv/{{ .Params.twitch }}">Watch on Twitch</a><br/>
          <span class="text-white">{{ .Params.Date.Local.Format "3 PM MST" }} on {{ .Params.Date.Format "Monday, Jan 02, 2006" }}</span>
        </div>
      </div>
    </div>
    <div class="col-4">
      <img src="{{ .Params.episode_banner | relURL }}">
    </div>
  </div>
  <!-- ELSE IF ON YOUTUBE -->
  <div id="youtube" class="row justify-content-center mb-5">
    <h1 class="h1 mb-3"> {{- .Title -}}</h1>
    <iframe width="800" height="450" src="https://www.youtube.com/embed/{{ .Params.youtube }}" frameborder="0" allowfullscreen></iframe>
  </div>

  <!-- END -->

  <script type="text/javascript">
    var twitch = document.getElementById("twitch");
    var youtube = document.getElementById("youtube");
    var currentTime = Date.now();
    var episodeTime = new Date("{{ .Params.Date }}").getTime();
    if (episodeTime < currentTime) {
      twitch.style.display = "none";
      youtube.style.display = "flex";
    }
    else {
      twitch.style.display = "flex";
      youtube.style.display = "none";
    }

  </script>

  <div class="row justify-content-center">
    <div class="col-9">
      <h3>In this episode</h3>
      {{ .Content }}
    </div>
  </div>

  {{ with .Params.guests }}
  <div class="row justify-content-center">
    <div class="col-9">
      <h3 class="mb-3">Guests</h3>
      {{ range . }}
        {{ with $.Site.GetPage (print "/team/" ( . | urlize )) }}
          <div class="border-bottom mb-4">
          {{ partial "team-member.html" (dict "context" . "display" "tv") }}
          </div>
        {{ end }}
      {{ end }}
    </div>
  </div>
  {{ end }}

  {{ with .Params.hosts }}
  <div class="row justify-content-center">
    <div class="col-9">
      <h3 class="mb-3">Hosts</h3>
      {{ range . }}
        {{ with $.Site.GetPage (print "/team/" ( . | urlize )) }}
          <div class="mb-4">
          {{ partial "team-member.html" (dict "context" . "display" "tv") }}
          </div>
        {{ end }}
      {{ end }}
    </div>
  </div>
  {{ end }}

</div>

{{ end }}